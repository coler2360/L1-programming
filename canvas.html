<!doctype html>

<head>

</head>

<body>
    <canvas id="gameCanvas" width="400" height="400"></canvas>;
    <script>
        var canvas, canvasContext;

        window.onload = function() {
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');

            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);



            setInterval(mainloop, 1000 / 50);

        }
        var alienYspeedMain = 0;
        
        var difficulty = '';
        var pass = false;
        
        while(pass == false){
            difficulty = prompt('what  do you want the game? easy or hard'); 
            if(difficulty.toLowerCase() == 'easy' || difficulty.toLowerCase() == 'hard'){
                pass = true;               
            }
        }
       // end of 
        
        if (difficulty == 'easy') {
            alienYspeedMain = 0.04;
        }else {
            alienYspeedMain = 0.10;
        }
        //end of alien diffuculty speed var//
        
        
        
        
        
        
        
        

        // player variables//
        var playerXpos = 0;
        var playerYpos = 0;
        var playerXspeed = 4;
        var playerYspeed = 3;
        const PLAYER_SPEED = 20;
        const PLAYER_SIZE = 30;

        var enenmyCount = 10;

        var enemy = [];

        // player controls//
        const LEFT_KEY = 37;
        const RIGHT_KEY = 39;
        const SPACE_KEY = 32;

        var leftKeyPressed = false;
        var rightKeyPressed = false;
        var spaceKeyPressed = false;

        //Bullet Variable//
        const BULLET_WIDTH = 5;
        const BULLET_HEIGHT = 10;
        var bulletXpos = 0;
        var bulletYpos = 0;
        var bulletYspeed = -5;

        var shooting = false;



        var startingPos = true;
        
        var alien = new Image();
       alien.src = 'images/Alien.png';

        var player = new Image();
        player.src = 'images/yah.png';
        
        var difficulty = '';
        var pass = false;





        function mainloop() {
            colorRect(0, 0, canvas.width, canvas.height, 'black'); //background  // 

            colorRect(bulletXpos, bulletYpos, BULLET_WIDTH, BULLET_HEIGHT, 'white');

            drawImg(player, playerXpos, playerYpos, PLAYER_SIZE, PLAYER_SIZE);

            //            moveAliens(alienXpos, alienYpos, alienYspeed, alienSize, alienSize);

            playerMove();
            bulletShoot();

            drawAliens();
           moveAliens();

            if (startingPos) {

                startPos();
                startingPos = false;
            }
        }
        //starting position for player//
        function startPos() {
            playerXpos = canvas.width / 2 - PLAYER_SIZE / 2;
            playerYpos = canvas.height - PLAYER_SIZE * 2;
        }

        function keyReleased(evt) {
            if (evt.keyCode == LEFT_KEY) {
                leftKeyPressed = false;
            }
            if (evt.keyCode == RIGHT_KEY) {
                rightKeyPressed = false;
            }
            if (evt.keyCode == SPACE_KEY) {
                spaceKeyPressed = false;
            }
        }

        function keyPressed(evt) {
            //            console.log(evt.keyCode);
            if (evt.keyCode == LEFT_KEY) {
                leftKeyPressed = true;
            }
            if (evt.keyCode == RIGHT_KEY) {
                rightKeyPressed = true;
            }
            if (evt.keyCode == SPACE_KEY) {
                spaceKeyPressed = true;
            }
        }


        function playerMove() {
            if (rightKeyPressed && playerXpos < canvas.width - PLAYER_SIZE) {
                playerXpos += playerXspeed; // x move
            }
            if (leftKeyPressed) {
                playerXpos -= playerXspeed; // x move
                if (playerXpos < 0 - PLAYER_SIZE) {
                    playerXpos = canvas.width - PLAYER_SIZE / 2;
                }
            }
        }


        
        function bulletShoot() {
            //            bulletYpos += bulletYspeed;

            if (spaceKeyPressed && shooting == false) {
                bulletXpos = playerXpos;
                bulletYpos = playerYpos;
                shooting = true;

            }
            if (shooting) {
                bulletYpos += bulletYspeed;

                if (bulletYpos - BULLET_HEIGHT < 0) {
                    shooting = false;
                    bulletXpos = 0;
                    bulletYpos = 0;
                }
            }
        }
        
        
        if (difficulty == 'easy') {
            alienYpeed = 10;
            
            
        }
        
        
         if (difficulty == 'hard') {
           alienYpeed = 60;
        }

        var Totalenemies = 32;
        var alienRowCount = 0;
        var aliens = [];
        var alienCount = 0;

        for (i = 0; i < Totalenemies; i++) {
            makeAliens();
        }


        function makeAliens() {
            const ALIEN_SIZE = 30;
            const gap = 10;
            var alienYpos = 10;
            var alienYspeed = alienYspeedMain;
            var alienXspeed = 3;
            var alienXpos = 0;

            if (alienCount != 0 && alienCount % 8 == 0) {
                alienRowCount++;
                alienYpos = ALIEN_SIZE * (alienRowCount * 1.5);
                alienXpos = alienCount % 8 * (ALIEN_SIZE * 1.5) + ALIEN_SIZE * .6;
                console.log(alienRowCount)
            } else {
                alienXpos = alienCount % 8 * (ALIEN_SIZE * 1.5) + ALIEN_SIZE * .6;
                alienYpos = ALIEN_SIZE * (alienRowCount * 1.5);
                console.log(alienRowCount)
            }
            alienCount++;

            alien = {
                ALIEN_SIZE: ALIEN_SIZE,
                alienXpos: alienXpos,
                alienYpos: alienYpos,
                alienYspeed: alienYspeed,
                alienXspeed: alienXspeed
            }
            aliens.push(alien);
        }

        function drawAliens() {
            aliens.forEach(function(alien, i) {
                colorRect(alien.alienXpos, alien.alienYpos, alien.ALIEN_SIZE, alien.ALIEN_SIZE,);
            });
        } // end drawAliens func `
        
        function moveAliens() {
            aliens.forEach(function(alien, i) {
    
                    alien.alienYpos += alien.alienYspeed;
        
                if (alien.alienYpos > canvas.height) {
                    alien.alienYpos = 0 - alien.ALIEN_SIZE;
                    alien.alienYspeed = alienYspeedMain;
                    console.log
                }
            });
        }

        function drawImg(src, x, y, w, h) {
            canvasContext.drawImage(src, x, y, w, h);
        }

        function colorRect(x, y, w, h, c) {
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x, y, w, h);
        }

    </script>
</body>
